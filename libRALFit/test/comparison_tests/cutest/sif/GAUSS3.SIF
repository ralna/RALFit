***************************
* SET UP THE INITIAL DATA *
***************************

NAME          GAUSS3

*   Problem :
*   *********

*   NIST Data fitting problem GAUSS3 given as an inconsistent set of
*   nonlinear equations.

*   Fit: y = b1*exp( -b2*x ) + b3*exp( -(x-b4)**2 / b5**2 )
*                            + b6*exp( -(x-b7)**2 / b8**2 ) + e

*   Source:  Problem from the NIST nonlinear regression test set
*     http://www.itl.nist.gov/div898/strd/nls/nls_main.shtml

*   Reference: Rust, B., NIST (1996).

*   SIF input: Nick Gould and Tyrone Rees, Oct 2015

*   classification NOR2-MN-8-250

*   Number of data values

 IE M                   250

*   Number of variables

 IE N                   8

*   Useful parameters

 IE 1                   1

*  Data values

 RE X1                  1.0  
 RE X2                  2.0  
 RE X3                  3.0  
 RE X4                  4.0  
 RE X5                  5.0  
 RE X6                  6.0  
 RE X7                  7.0  
 RE X8                  8.0  
 RE X9                  9.0  
 RE X10                 10.0 
 RE X11                 11.0 
 RE X12                 12.0 
 RE X13                 13.0 
 RE X14                 14.0 
 RE X15                 15.0 
 RE X16                 16.0 
 RE X17                 17.0 
 RE X18                 18.0 
 RE X19                 19.0 
 RE X20                 20.0 
 RE X21                 21.0 
 RE X22                 22.0 
 RE X23                 23.0 
 RE X24                 24.0 
 RE X25                 25.0 
 RE X26                 26.0 
 RE X27                 27.0 
 RE X28                 28.0 
 RE X29                 29.0 
 RE X30                 30.0 
 RE X31                 31.0 
 RE X32                 32.0 
 RE X33                 33.0 
 RE X34                 34.0 
 RE X35                 35.0 
 RE X36                 36.0 
 RE X37                 37.0 
 RE X38                 38.0 
 RE X39                 39.0 
 RE X40                 40.0 
 RE X41                 41.0 
 RE X42                 42.0 
 RE X43                 43.0 
 RE X44                 44.0 
 RE X45                 45.0 
 RE X46                 46.0 
 RE X47                 47.0 
 RE X48                 48.0 
 RE X49                 49.0 
 RE X50                 50.0 
 RE X51                 51.0 
 RE X52                 52.0 
 RE X53                 53.0 
 RE X54                 54.0 
 RE X55                 55.0 
 RE X56                 56.0 
 RE X57                 57.0 
 RE X58                 58.0 
 RE X59                 59.0 
 RE X60                 60.0 
 RE X61                 61.0 
 RE X62                 62.0 
 RE X63                 63.0 
 RE X64                 64.0 
 RE X65                 65.0 
 RE X66                 66.0 
 RE X67                 67.0 
 RE X68                 68.0 
 RE X69                 69.0 
 RE X70                 70.0 
 RE X71                 71.0 
 RE X72                 72.0 
 RE X73                 73.0 
 RE X74                 74.0 
 RE X75                 75.0 
 RE X76                 76.0 
 RE X77                 77.0 
 RE X78                 78.0 
 RE X79                 79.0 
 RE X80                 80.0 
 RE X81                 81.0 
 RE X82                 82.0 
 RE X83                 83.0 
 RE X84                 84.0 
 RE X85                 85.0 
 RE X86                 86.0 
 RE X87                 87.0 
 RE X88                 88.0 
 RE X89                 89.0 
 RE X90                 90.0 
 RE X91                 91.0 
 RE X92                 92.0 
 RE X93                 93.0 
 RE X94                 94.0 
 RE X95                 95.0 
 RE X96                 96.0 
 RE X97                 97.0 
 RE X98                 98.0 
 RE X99                 99.0 
 RE X100                100.0
 RE X101                101.0
 RE X102                102.0
 RE X103                103.0
 RE X104                104.0
 RE X105                105.0
 RE X106                106.0
 RE X107                107.0
 RE X108                108.0
 RE X109                109.0
 RE X110                110.0
 RE X111                111.0
 RE X112                112.0
 RE X113                113.0
 RE X114                114.0
 RE X115                115.0
 RE X116                116.0
 RE X117                117.0
 RE X118                118.0
 RE X119                119.0
 RE X120                120.0
 RE X121                121.0
 RE X122                122.0
 RE X123                123.0
 RE X124                124.0
 RE X125                125.0
 RE X126                126.0
 RE X127                127.0
 RE X128                128.0
 RE X129                129.0
 RE X130                130.0
 RE X131                131.0
 RE X132                132.0
 RE X133                133.0
 RE X134                134.0
 RE X135                135.0
 RE X136                136.0
 RE X137                137.0
 RE X138                138.0
 RE X139                139.0
 RE X140                140.0
 RE X141                141.0
 RE X142                142.0
 RE X143                143.0
 RE X144                144.0
 RE X145                145.0
 RE X146                146.0
 RE X147                147.0
 RE X148                148.0
 RE X149                149.0
 RE X150                150.0
 RE X151                151.0
 RE X152                152.0
 RE X153                153.0
 RE X154                154.0
 RE X155                155.0
 RE X156                156.0
 RE X157                157.0
 RE X158                158.0
 RE X159                159.0
 RE X160                160.0
 RE X161                161.0
 RE X162                162.0
 RE X163                163.0
 RE X164                164.0
 RE X165                165.0
 RE X166                166.0
 RE X167                167.0
 RE X168                168.0
 RE X169                169.0
 RE X170                170.0
 RE X171                171.0
 RE X172                172.0
 RE X173                173.0
 RE X174                174.0
 RE X175                175.0
 RE X176                176.0
 RE X177                177.0
 RE X178                178.0
 RE X179                179.0
 RE X180                180.0
 RE X181                181.0
 RE X182                182.0
 RE X183                183.0
 RE X184                184.0
 RE X185                185.0
 RE X186                186.0
 RE X187                187.0
 RE X188                188.0
 RE X189                189.0
 RE X190                190.0
 RE X191                191.0
 RE X192                192.0
 RE X193                193.0
 RE X194                194.0
 RE X195                195.0
 RE X196                196.0
 RE X197                197.0
 RE X198                198.0
 RE X199                199.0
 RE X200                200.0
 RE X201                201.0
 RE X202                202.0
 RE X203                203.0
 RE X204                204.0
 RE X205                205.0
 RE X206                206.0
 RE X207                207.0
 RE X208                208.0
 RE X209                209.0
 RE X210                210.0
 RE X211                211.0
 RE X212                212.0
 RE X213                213.0
 RE X214                214.0
 RE X215                215.0
 RE X216                216.0
 RE X217                217.0
 RE X218                218.0
 RE X219                219.0
 RE X220                220.0
 RE X221                221.0
 RE X222                222.0
 RE X223                223.0
 RE X224                224.0
 RE X225                225.0
 RE X226                226.0
 RE X227                227.0
 RE X228                228.0
 RE X229                229.0
 RE X230                230.0
 RE X231                231.0
 RE X232                232.0
 RE X233                233.0
 RE X234                234.0
 RE X235                235.0
 RE X236                236.0
 RE X237                237.0
 RE X238                238.0
 RE X239                239.0
 RE X240                240.0
 RE X241                241.0
 RE X242                242.0
 RE X243                243.0
 RE X244                244.0
 RE X245                245.0
 RE X246                246.0
 RE X247                247.0
 RE X248                248.0
 RE X249                249.0
 RE X250                250.0

 RE Y1                   97.58776
 RE Y2                   97.76344
 RE Y3                   96.56705
 RE Y4                   92.52037
 RE Y5                   91.15097
 RE Y6                   95.21728
 RE Y7                   90.21355
 RE Y8                   89.29235
 RE Y9                   91.51479
 RE Y10                  89.60965
 RE Y11                  86.56187
 RE Y12                  85.55315
 RE Y13                  87.13053
 RE Y14                  85.67938
 RE Y15                  80.04849
 RE Y16                  82.18922
 RE Y17                  87.24078
 RE Y18                  80.79401
 RE Y19                  81.28564
 RE Y20                  81.56932
 RE Y21                  79.22703
 RE Y22                  79.43259
 RE Y23                  77.90174
 RE Y24                  76.75438
 RE Y25                  77.17338
 RE Y26                  74.27296
 RE Y27                  73.11830
 RE Y28                  73.84732
 RE Y29                  72.47746
 RE Y30                  71.92128
 RE Y31                  66.91962
 RE Y32                  67.93554
 RE Y33                  69.55841
 RE Y34                  69.06592
 RE Y35                  66.53371
 RE Y36                  63.87094
 RE Y37                  69.70526
 RE Y38                  63.59295
 RE Y39                  63.35509
 RE Y40                  59.99747
 RE Y41                  62.64843
 RE Y42                  65.77345
 RE Y43                  59.10141
 RE Y44                  56.57750
 RE Y45                  61.15313
 RE Y46                  54.30767
 RE Y47                  62.83535
 RE Y48                  56.52957
 RE Y49                  56.98427
 RE Y50                  58.11459
 RE Y51                  58.69576
 RE Y52                  58.23322
 RE Y53                  54.90490
 RE Y54                  57.91442
 RE Y55                  56.96629
 RE Y56                  51.13831
 RE Y57                  49.27123
 RE Y58                  52.92668
 RE Y59                  54.47693
 RE Y60                  51.81710
 RE Y61                  51.05401
 RE Y62                  52.51731
 RE Y63                  51.83710
 RE Y64                  54.48196
 RE Y65                  49.05859
 RE Y66                  50.52315
 RE Y67                  50.32755
 RE Y68                  46.44419
 RE Y69                  50.89281
 RE Y70                  52.13203
 RE Y71                  49.78741
 RE Y72                  49.01637
 RE Y73                  54.18198
 RE Y74                  53.17456
 RE Y75                  53.20827
 RE Y76                  57.43459
 RE Y77                  51.95282
 RE Y78                  54.20282
 RE Y79                  57.46687
 RE Y80                  53.60268
 RE Y81                  58.86728
 RE Y82                  57.66652
 RE Y83                  63.71034
 RE Y84                  65.24244
 RE Y85                  65.10878
 RE Y86                  69.96313
 RE Y87                  68.85475
 RE Y88                  73.32574
 RE Y89                  76.21241
 RE Y90                  78.06311
 RE Y91                  75.37701
 RE Y92                  87.54449
 RE Y93                  89.50588
 RE Y94                  95.82098
 RE Y95                  97.48390
 RE Y96                 100.86070
 RE Y97                 102.48510
 RE Y98                  105.7311
 RE Y99                  111.3489
 RE Y100                 111.0305
 RE Y101                 110.1920
 RE Y102                 118.3581
 RE Y103                 118.8086
 RE Y104                 122.4249
 RE Y105                 124.0953
 RE Y106                 125.9337
 RE Y107                 127.8533
 RE Y108                 131.0361
 RE Y109                 133.3343
 RE Y110                 135.1278
 RE Y111                 131.7113
 RE Y112                 131.9151
 RE Y113                 132.1107
 RE Y114                 127.6898
 RE Y115                 133.2148
 RE Y116                 128.2296
 RE Y117                 133.5902
 RE Y118                 127.2539
 RE Y119                 128.3482
 RE Y120                 124.8694
 RE Y121                 124.6031
 RE Y122                 117.0648
 RE Y123                 118.1966
 RE Y124                 119.5408
 RE Y125                 114.7946
 RE Y126                 114.2780
 RE Y127                 120.3484
 RE Y128                 114.8647
 RE Y129                 111.6514
 RE Y130                 110.1826
 RE Y131                 108.4461
 RE Y132                 109.0571
 RE Y133                 106.5308
 RE Y134                 109.4691
 RE Y135                 106.8709
 RE Y136                 107.3192
 RE Y137                 106.9000
 RE Y138                 109.6526
 RE Y139                 107.1602
 RE Y140                 108.2509
 RE Y141                104.96310
 RE Y142                 109.3601
 RE Y143                 107.6696
 RE Y144                 99.77286
 RE Y145                104.96440
 RE Y146                 106.1376
 RE Y147                 106.5816
 RE Y148                100.12860
 RE Y149                101.66910
 RE Y150                 96.44254
 RE Y151                 97.34169
 RE Y152                 96.97412
 RE Y153                 90.73460
 RE Y154                 93.37949
 RE Y155                 82.12331
 RE Y156                 83.01657
 RE Y157                 78.87360
 RE Y158                 74.86971
 RE Y159                 72.79341
 RE Y160                 65.14744
 RE Y161                 67.02127
 RE Y162                 60.16136
 RE Y163                 57.13996
 RE Y164                 54.05769
 RE Y165                 50.42265
 RE Y166                 47.82430
 RE Y167                 42.85748
 RE Y168                 42.45495
 RE Y169                 38.30808
 RE Y170                 36.95794
 RE Y171                 33.94543
 RE Y172                 34.19017
 RE Y173                 31.66097
 RE Y174                 23.56172
 RE Y175                 29.61143
 RE Y176                 23.88765
 RE Y177                 22.49812
 RE Y178                 24.86901
 RE Y179                 17.29481
 RE Y180                 18.09291
 RE Y181                 15.34813
 RE Y182                 14.77997
 RE Y183                 13.87832
 RE Y184                 12.88891
 RE Y185                 16.20763
 RE Y186                 16.29024
 RE Y187                 15.29712
 RE Y188                 14.97839
 RE Y189                 12.11330
 RE Y190                 14.24168
 RE Y191                 12.53824
 RE Y192                 15.19818
 RE Y193                 11.70478
 RE Y194                 15.83745
 RE Y195                10.035850
 RE Y196                 9.307574
 RE Y197                 12.86800
 RE Y198                 8.571671
 RE Y199                 11.60415
 RE Y200                 12.42772
 RE Y201                 11.23627
 RE Y202                 11.13198
 RE Y203                 7.761117
 RE Y204                 6.758250
 RE Y205                 14.23375
 RE Y206                 10.63876
 RE Y207                 8.893581
 RE Y208                 11.55398
 RE Y209                 11.57221
 RE Y210                 11.58347
 RE Y211                 9.724857
 RE Y212                 11.43854
 RE Y213                 11.22636
 RE Y214                10.170150
 RE Y215                 12.50765
 RE Y216                 6.200494
 RE Y217                 9.018902
 RE Y218                 10.80557
 RE Y219                 13.09591
 RE Y220                 3.914033
 RE Y221                 9.567723
 RE Y222                 8.038338
 RE Y223                10.230960
 RE Y224                 9.367358
 RE Y225                 7.695937
 RE Y226                 6.118552
 RE Y227                 8.793192
 RE Y228                 7.796682
 RE Y229                 12.45064
 RE Y230                 10.61601
 RE Y231                 6.001000
 RE Y232                 6.765096
 RE Y233                 8.764652
 RE Y234                 4.586417
 RE Y235                 8.390782
 RE Y236                 7.209201
 RE Y237                10.012090
 RE Y238                 7.327461
 RE Y239                 6.525136
 RE Y240                 2.840065
 RE Y241                10.323710
 RE Y242                 4.790035
 RE Y243                 8.376431
 RE Y244                 6.263980
 RE Y245                 2.705892
 RE Y246                 8.362109
 RE Y247                 8.983507
 RE Y248                 3.362469
 RE Y249                 1.182678
 RE Y250                 4.875312

VARIABLES

 DO I         1                        N
 X  B(I)
 ND

GROUPS

 DO I         1                        M
 XE F(I)
 ND

CONSTANTS

 DO I         1                        M
 Z  GAUSS3    F(I)                     Y(I)
 ND        

BOUNDS

 FR GAUSS3    'DEFAULT'

START POINT

    START1    B1        94.9 
    START1    B2        0.009
    START1    B3        90.1 
    START1    B4        113.0
    START1    B5        20.0 
    START1    B6        73.8 
    START1    B7        140.0
    START1    B8        20.0 

*  Alternative start point

    START2    B1        96.0  
    START2    B2        0.0096
    START2    B3        80.0  
    START2    B4        110.0 
    START2    B5        25.0  
    START2    B6        74.0  
    START2    B7        139.0 
    START2    B8        25.0  

ELEMENT TYPE

 EV E2        V1
 EV E2        V2
 EP E2        X
 EV E17       V1
 EV E17       V2
 EV E17       V3
 EP E17       X

ELEMENT USES

 DO I         1                        M
 XT EA(I)     E2
 ZV EA(I)     V1                       B1
 ZV EA(I)     V2                       B2
 ZP EA(I)     X                        X(I)
 XT EB(I)     E17
 ZV EB(I)     V1                       B3
 ZV EB(I)     V2                       B4
 ZV EB(I)     V3                       B5
 ZP EB(I)     X                        X(I)
 XT EC(I)     E17
 ZV EC(I)     V1                       B6
 ZV EC(I)     V2                       B7
 ZV EC(I)     V3                       B8
 ZP EC(I)     X                        X(I)
 ND

GROUP USES

 DO I         1                        M
 XE F(I)      EA(I)
 XE F(I)      EB(I)
 XE F(I)      EC(I)
 ND

OBJECT BOUND

*   Least square problems are bounded below by zero

 LO GAUSS3              0.0

*   Solution

*LO SOLTN               

ENDATA

***********************
* SET UP THE FUNCTION *
* AND RANGE ROUTINES  *
***********************

ELEMENTS      GAUSS3

TEMPORARIES

 R  E
 R  V1E
 R  V2MX
 R  V2MX2
 R  TV2MX
 R  TV2MX2
 R  TV2MXV
 R  TV2MXW
 R  R
 R  A
 R  V32
 R  V33
 R  TV1E
 M  EXP

INDIVIDUALS

 T  E2
 A  E                   EXP( - V2 * X )
 A  V1E                 V1 * E

 F                      V1E
 G  V1                  E 
 G  V2                  - V1E * X
 H  V1        V2        - X * E
 H  V2        V2        V1E * X ** 2

 T  E17
 A  V2MX                V2 - X
 A  V2MX2               V2MX *V2MX
 A  TV2MX               2.0 * V2MX
 A  TV2MX2              2.0 * V2MX2
 A  R                   V2MX / V3
 A  A                   - R * R
 A  E                   EXP( A )
 A  V32                 V3 * V3
 A  V33                 V3 * V32
 A  V1E                 V1 * E
 A  TV1E                2.0 * V1E
 A  TV2MXV              TV2MX / V32 
 A  TV2MXW              TV2MX2 / V32

 F                      V1E
 G  V1                  E
 G  V2                  - V1E * TV2MXV 
 G  V3                  TV1E * V2MX2 / V33
 H  V1        V2        - E * TV2MXV
 H  V1        V3        E * TV2MX2 / V33 
 H  V2        V2        TV1E * ( TV2MXW - 1.0 ) / V32
 H  V2        V3        TV1E * TV2MX * 
 H+                      ( 1.0 - V2MX2 / V32 ) / V33
 H  V3        V3        TV1E * V2MX2 * 
 H+                       ( TV2MXW - 3.0 ) / V3 ** 4
ENDATA
